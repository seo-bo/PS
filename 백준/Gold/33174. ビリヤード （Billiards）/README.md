# [Gold V] ビリヤード (Billiards) - 33174 

[문제 링크](https://www.acmicpc.net/problem/33174) 

### 성능 요약

메모리: 27064 KB, 시간: 92 ms

### 분류

다이나믹 프로그래밍, 트리에서의 다이나믹 프로그래밍, 그래프 이론, 트리

### 제출 일자

2025년 5월 6일 21:18:40

### 문제 설명

<p>ビ太郎はビリヤードで遊んでいる． JOI 国のビリヤードは台上に並べられた <var>N</var> 個のボール <var>1,2,...,N</var> を用いる遊びであり，台にはボールを落とすための穴が設けられている． 一度穴に落ちたボールは台上には戻さず，そのボールを再び落とすことはできない．ビ太郎の目的は，なるべく大きい番号の書かれたボールを穴に落とすことである．</p>

<p>ボールを落とすのは集中を必要とする作業である． はじめ，ビ太郎の <strong>集中力</strong> は <var>X</var> であり，ボール <var>i</var> (<var>1 ≦ i ≦ N</var>) を落とすと集中力が <var>A<sub>i</sub></var> 減少する．集中力が <var>A<sub>i</sub></var> 未満であるとき，ボール <var>i</var> を落とすことはできない．</p>

<p>また，このビリヤードではボールを落とす順番に関するルールが存在する．具体的には， <var>P<sub>i</sub> = -1</var> (<var>1 ≦ i ≦ N</var>) のとき，ボール <var>i</var> はいつでも落とすことができ， <var>P<sub>i</sub> ≠ -1</var> のとき，ボール <var>i</var> を落とすためには，ボール <var>P<sub>i</sub></var> がすでに落とされている必要がある．</p>

<p>ビ太郎が持つ集中力と各ボールの情報が与えられたとき，ビ太郎がボールを穴に落とすことができるか判定し，ボールを落とすことができる場合は落とせるボールの番号の最大値を求めるプログラムを作成せよ．</p>

### 입력 

 <p>入力は以下の形式で与えられる．</p>

<pre><var>N</var> <var>X</var>
<var>A<sub>1</sub></var> <var>A<sub>2</sub></var> <var>…</var> <var>A<sub>N</sub></var>
<var>P<sub>1</sub></var> <var>P<sub>2</sub></var> <var>…</var> <var>P<sub>N</sub></var></pre>

### 출력 

 <p>ビ太郎が穴に落とすことのできるボールの番号の最大値を <var>1</var> 行に出力せよ．</p>

<p>ただし，ビ太郎が <var>1</var> 個もボールを落とすことができない場合は代わりに <code>-1</code> と出力せよ．</p>

